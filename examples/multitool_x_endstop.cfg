# Example Klipper Configuration for Multitool X Endstops
# This file demonstrates how to integrate the dynamic X endstop switching.

[tool_x_router]
# The central router that coordinates endstop switching during homing.
# It intercepts X homing and triggers tool detection.

[stepper_x]
step_pin: PB13
dir_pin: PB12
enable_pin: !PB14
microsteps: 16
rotation_distance: 40
# Use the virtual endstop provided by the tool_x_router
endstop_pin: tool_x_router:x_virtual_endstop
position_endstop: 0
position_max: 250
homing_speed: 50

# Configuration for Tool 0 (T0)
[tool_x_endstop T0]
pin: ^EBBCan:PB6    # The physical pin on the T0 toolhead/MCU
tool: 0             # Match the tool number detected by tool_probe_endstop

# Configuration for Tool 1 (T1)
[tool_x_endstop T1]
pin: ^EBBCan_T1:PB6 # The physical pin on the T1 toolhead/MCU
tool: 1             # Match the tool number detected by tool_probe_endstop

# Configuration for Tool 2 (T2)
[tool_x_endstop T2]
pin: ^EBBCan_T2:PB6 # The physical pin on the T2 toolhead/MCU
tool: 2

# [IMPORTANT] Ensure that [tool_probe_endstop] is also configured, 
# as the router depends on it for detecting the active tool.
